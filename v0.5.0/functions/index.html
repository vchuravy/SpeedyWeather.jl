<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Function and type index · SpeedyWeather.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">SpeedyWeather.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../how_to_run_speedy/">How to run SpeedyWeather.jl</a></li><li><a class="tocitem" href="../spectral_transform/">Spherical harmonic transform</a></li><li><a class="tocitem" href="../grids/">Grids</a></li><li><a class="tocitem" href="../dynamical_core/">Dynamical core</a></li><li><a class="tocitem" href="../parametrizations/">Parameterizations</a></li><li><a class="tocitem" href="../boundary_conditions/">Boundary conditions</a></li><li><a class="tocitem" href="../new_model_setups/">New model setups</a></li><li class="is-active"><a class="tocitem" href>Function and type index</a><ul class="internal"><li><a class="tocitem" href="#Parameters-and-constants"><span>Parameters and constants</span></a></li><li><a class="tocitem" href="#Boundaries-and-boundary-conditions"><span>Boundaries and boundary conditions</span></a></li><li><a class="tocitem" href="#Spherical-harmonic-transform"><span>Spherical harmonic transform</span></a></li><li><a class="tocitem" href="#Dynamics"><span>Dynamics</span></a></li><li><a class="tocitem" href="#Geometry"><span>Geometry</span></a></li><li><a class="tocitem" href="#Time-stepping"><span>Time stepping</span></a></li><li><a class="tocitem" href="#Longwave-radiation"><span>Longwave radiation</span></a></li><li><a class="tocitem" href="#Shortwave-radiation"><span>Shortwave radiation</span></a></li></ul></li><li><a class="tocitem" href="../conventions/">Style and convention guide</a></li><li><a class="tocitem" href="../development/">Development notes</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Function and type index</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Function and type index</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/main/docs/src/functions.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Function-and-type-index"><a class="docs-heading-anchor" href="#Function-and-type-index">Function and type index</a><a id="Function-and-type-index-1"></a><a class="docs-heading-anchor-permalink" href="#Function-and-type-index" title="Permalink"></a></h1><h2 id="Parameters-and-constants"><a class="docs-heading-anchor" href="#Parameters-and-constants">Parameters and constants</a><a id="Parameters-and-constants-1"></a><a class="docs-heading-anchor-permalink" href="#Parameters-and-constants" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.Parameters" href="#SpeedyWeather.Parameters"><code>SpeedyWeather.Parameters</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">P = Parameters{M&lt;:ModelSetup}(kwargs...) &lt;: AbstractParameters{M}</code></pre><p>A struct to hold all model parameters that may be changed by the user. The struct uses keywords such that default values can be changed at creation. The default values of the keywords define the default model setup.</p><ul><li><p><code>NF::DataType</code>: number format</p></li><li><p><code>trunc::Int64</code>: spectral truncation</p></li><li><p><code>Grid::Type{&lt;:SpeedyWeather.RingGrids.AbstractGrid}</code>: grid in use</p></li><li><p><code>dealiasing::Float64</code>: dealiasing factor, 1=linear, 2=quadratic, 3=cubic grid</p></li><li><p><code>planet::SpeedyWeather.Planet</code>: planet</p></li><li><p><code>mol_mass_dry_air::Any</code>: molar mass of dry air [g/mol]</p></li><li><p><code>mol_mass_vapour::Any</code>: molar mass of water vapour [g/mol]</p></li><li><p><code>cₚ::Float64</code>: specific heat at constant pressure [J/K/kg]</p></li><li><p><code>R_gas::Float64</code>: universal gas constant [J/K/mol]</p></li><li><p><code>R_dry::Float64</code>: specific gas constant for dry air [J/kg/K]</p></li><li><p><code>R_vapour::Float64</code>: specific gas constant for water vapour [J/kg/K]</p></li><li><p><code>alhc::Float64</code>: latent heat of condensation [J/g] for consistency with specific humidity [g/Kg]</p></li><li><p><code>alhs::Float64</code>: latent heat of sublimation [?]</p></li><li><p><code>sbc::Float64</code>: stefan-Boltzmann constant [W/m²/K⁴]</p></li><li><p><code>lapse_rate::Float64</code>: moist adiabatic temperature lapse rate <span>$-dT/dz$</span> [K/km]</p></li><li><p><code>temp_ref::Float64</code>: absolute temperature at surface <span>$z=0$</span> [K]</p></li><li><p><code>temp_top::Float64</code>: absolute temperature in stratosphere [K]</p></li><li><p><code>ΔT_stratosphere::Float64</code>: for stratospheric lapse rate [K] after Jablonowski</p></li><li><p><code>scale_height::Float64</code>: scale height for pressure [km]</p></li><li><p><code>pres_ref::Float64</code>: surface pressure [hPa]</p></li><li><p><code>scale_height_humid::Float64</code>: scale height for specific humidity [km]</p></li><li><p><code>relhumid_ref::Float64</code>: relative humidity of near-surface air [1]</p></li><li><p><code>water_pres_ref::Float64</code>: saturation water vapour pressure [Pa]</p></li><li><p><code>layer_thickness::Float64</code>: layer thickness for the shallow water model [km]</p></li><li><p><code>GLcoefs::SpeedyWeather.Coefficients</code>: vertical coordinates of the nlev vertical levels, defined by a generalised logistic function, interpolating ECMWF&#39;s L31 configuration</p></li><li><p><code>σ_tropopause::Float64</code>: σ coordinate where the tropopause starts</p></li><li><p><code>σ_levels_half::Vector{Float64}</code>: only used if set manually, otherwise empty</p></li><li><p><code>nlev::Int64</code>: number of vertical levels</p></li><li><p><code>diffusion::SpeedyWeather.DiffusionParameters</code>: horizontal (hyper)-diffusion</p></li><li><p><code>vertical_diffusion::SpeedyWeather.VerticalDiffusion</code>: vertical diffusion</p></li><li><p><code>static_energy_diffusion::SpeedyWeather.VerticalDiffusion</code>: static energy diffusion</p></li><li><p><code>interface_relaxation::Bool</code>: turn on interface relaxation for shallow water?</p></li><li><p><code>interface_relax_time::Float64</code>: time scale [hrs] of interface relaxation</p></li><li><p><code>interface_relax_amplitude::Float64</code>: Amplitude [m] of interface relaxation</p></li><li><p><code>physics::Bool</code>: en/disables the physics parameterizations</p></li><li><p><code>n_shortwave::Int64</code>: Compute shortwave radiation every <code>n</code> steps</p></li><li><p><code>sppt_on::Bool</code>: Turn on SPPT?</p></li><li><p><code>magnus_coefs::SpeedyWeather.Coefficients</code>: For computing saturation vapour pressure</p></li><li><p><code>k_lsc::Int64</code>: Index of atmospheric level at which large-scale condensation begins</p></li><li><p><code>RH_thresh_pbl_lsc::Float64</code>: Relative humidity threshold for boundary layer</p></li><li><p><code>RH_thresh_range_lsc::Float64</code>: Vertical range of relative humidity threshold</p></li><li><p><code>RH_thresh_max_lsc::Float64</code>: Maximum relative humidity threshold</p></li><li><p><code>humid_relax_time_lsc::Float64</code>: Relaxation time for humidity (hours)</p></li><li><p><code>pres_thresh_cnv::Float64</code>: Minimum (normalised) surface pressure for the occurrence of convection</p></li><li><p><code>RH_thresh_pbl_cnv::Float64</code>: Relative humidity threshold for convection in PBL</p></li><li><p><code>RH_thresh_trop_cnv::Float64</code>: Relative humidity threshold for convection in the troposphere</p></li><li><p><code>humid_relax_time_cnv::Float64</code>: Relaxation time for PBL humidity (hours)</p></li><li><p><code>max_entrainment::Float64</code>: Maximum entrainment as a fraction of cloud-base mass flux</p></li><li><p><code>ratio_secondary_mass_flux::Float64</code>: Ratio between secondary and primary mass flux at cloud-base</p></li><li><p><code>nband::Int64</code>: Number of bands used to compute <code>fband</code></p></li><li><p><code>radiation_coefs::SpeedyWeather.Coefficients</code>: radiation coefficients</p></li><li><p><code>boundary_layer::SpeedyWeather.BoundaryLayer{Float64}</code>: boundary layer drag</p></li><li><p><code>temperature_relaxation::SpeedyWeather.TemperatureRelaxation{Float64}</code>: temperature relaxation</p></li><li><p><code>startdate::Dates.DateTime</code>: time at which the integration starts</p></li><li><p><code>n_days::Float64</code>: number of days to integrate for</p></li><li><p><code>Δt_at_T31::Float64</code>: time step in minutes for T31, scale linearly to <code>trunc</code></p></li><li><p><code>robert_filter::Float64</code>: Robert (1966) time filter coefficeint to suppress comput. mode</p></li><li><p><code>williams_filter::Float64</code>: William&#39;s time filter (Amezcua 2011) coefficient for 3rd order acc</p></li><li><p><code>implicit_α::Float64</code>: coefficient for semi-implicit computations to filter gravity waves</p></li><li><p><code>recalculate_implicit::Int64</code>: recalculate implicit operators on temperature profile every n time steps</p></li><li><p><code>recompute_legendre::Bool</code>: recomputation is slower but requires less memory</p></li><li><p><code>legendre_NF::DataType</code>: which format to use to calculate the Legendre polynomials</p></li><li><p><code>legendre_shortcut::Symbol</code>: <code>:linear</code>, <code>:quadratic</code>, <code>:cubic</code>, <code>:lincub_coslat</code>, <code>:linquad_coslat²</code></p></li><li><p><code>boundary_path::String</code>: package location is default</p></li><li><p><code>orography::SpeedyWeather.AbstractOrography</code>: orography</p></li><li><p><code>orography_scale::Float64</code>: scale orography by a factor</p></li><li><p><code>orography_path::String</code>: path of orography</p></li><li><p><code>orography_file::String</code>: filename of orography</p></li><li><p><code>seed::Int64</code>: random seed for the global random number generator</p></li><li><p><code>initial_conditions::SpeedyWeather.InitialConditions</code>: initial conditions</p></li><li><p><code>pressure_on_orography::Bool</code>: calculate the initial surface pressure from orography</p></li><li><p><code>verbose::Bool</code>: print dialog for feedback</p></li><li><p><code>debug::Bool</code>: print debug info, NaR detection</p></li><li><p><code>output::Bool</code>: Store data in netCDF?</p></li><li><p><code>output_dt::Float64</code>: output time step [hours]</p></li><li><p><code>output_path::String</code>: path to output folder</p></li><li><p><code>run_id::Union{Int64, String}</code>: name of the output folder, defaults to 4-digit number counting up from <code>run-0001</code></p></li><li><p><code>output_filename::String</code>: name of the output netcdf file</p></li><li><p><code>output_vars::Vector{Symbol}</code>: variables to output: <code>:u</code>, <code>:v</code>, <code>:vor</code>, <code>:div</code>, <code>:temp</code>, <code>:humid</code></p></li><li><p><code>compression_level::Int64</code>: compression level; 1=low but fast, 9=high but slow</p></li><li><p><code>keepbits::NamedTuple</code>: mantissa bits to keep for every variable</p></li><li><p><code>version::VersionNumber</code>: SpeedyWeather.jl version number</p></li><li><p><code>output_NF::DataType</code>: number format used for output</p></li><li><p><code>output_nlat_half::Int64</code>: 0 = reuse nlat_half from dynamical core</p></li><li><p><code>output_Grid::Type{&lt;:SpeedyWeather.RingGrids.AbstractFullGrid}</code>: output grid</p></li><li><p><code>output_Interpolator::Type{&lt;:SpeedyWeather.RingGrids.AbstractInterpolator}</code>: output interpolator</p></li><li><p><code>output_matrix::Bool</code>: if true sort gridpoints into a matrix</p></li><li><p><code>output_quadrant_rotation::NTuple{4, Int64}</code>: rotation of output quadrant</p></li><li><p><code>output_matrix_quadrant::NTuple{4, Tuple{Int64, Int64}}</code>: matrix of output quadrant</p></li><li><p><code>missing_value::Float64</code>: missing value to be used in netcdf output</p></li><li><p><code>write_restart::Bool</code>: also write restart file if output==true?</p></li><li><p><code>restart_path::String</code>: path for restart file</p></li><li><p><code>restart_id::Union{Int64, String}</code>: <code>run_id</code> of restart file in <code>run-????/restart.jld2</code></p></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/default_parameters.jl#L4-L12">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.Constants</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Boundaries-and-boundary-conditions"><a class="docs-heading-anchor" href="#Boundaries-and-boundary-conditions">Boundaries and boundary conditions</a><a id="Boundaries-and-boundary-conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Boundaries-and-boundary-conditions" title="Permalink"></a></h2><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.Boundaries</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Spherical-harmonic-transform"><a class="docs-heading-anchor" href="#Spherical-harmonic-transform">Spherical harmonic transform</a><a id="Spherical-harmonic-transform-1"></a><a class="docs-heading-anchor-permalink" href="#Spherical-harmonic-transform" title="Permalink"></a></h2><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.GeoSpectral</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.SpectralTransform" href="#SpeedyWeather.SpeedyTransforms.SpectralTransform"><code>SpeedyWeather.SpeedyTransforms.SpectralTransform</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">S = SpectralTransform{NF&lt;:AbstractFloat}(...)</code></pre><p>SpectralTransform struct that contains all parameters and preallocated arrays for the spectral transform.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_transform.jl#L1-L5">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral" href="#SpeedyWeather.SpeedyTransforms.spectral"><code>SpeedyWeather.SpeedyTransforms.spectral</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">alms = spectral(    map::AbstractMatrix;
                    Grid::Type{&lt;:AbstractGrid}=DEFAULT_GRID,
                    kwargs...)</code></pre><p>Converts <code>map</code> to <code>grid(map)</code> to execute <code>spectral(map::AbstractGrid;kwargs...)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_transform.jl#L578-L583">source</a></section><section><div><pre><code class="nohighlight hljs">alms = spectral(    map::AbstractGrid;
                    Grid::Type{&lt;:AbstractGrid}=DEFAULT_GRID,
                    kwargs...)</code></pre><p>Converts <code>map</code> to <code>Grid(map)</code> to execute <code>spectral(map::AbstractGrid;kwargs...)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_transform.jl#L591-L596">source</a></section><section><div><pre><code class="nohighlight hljs">alms = spectral(    map::AbstractMatrix;
                    Grid::Type{&lt;:AbstractGrid}=DEFAULT_GRID,
                    kwargs...)</code></pre><p>Spectral transform (grid to spectral) <code>map</code> to <code>grid(map)</code> to execute <code>spectral(map::AbstractGrid;kwargs...)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_transform.jl#L607-L612">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral!" href="#SpeedyWeather.SpeedyTransforms.spectral!"><code>SpeedyWeather.SpeedyTransforms.spectral!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">spectral!(  alms::LowerTriangularMatrix,
            map::AbstractGrid,
            S::SpectralTransform)</code></pre><p>Spectral transform (grid to spectral space) from the gridded field <code>map</code> on a <code>grid&lt;:AbstractGrid</code> to a <code>LowerTriangularMatrix</code> of spherical harmonic coefficients <code>alms</code>. Uses FFT in the zonal direction, and a Legendre Transform in the meridional direction exploiting symmetries. The spectral transform is number format-flexible as long as the parametric types of <code>map</code>, <code>alms</code>, <code>S</code> are identical. The spectral transform is grid-flexible as long as the <code>typeof(map)&lt;:AbstractGrid</code>.  Uses the precalculated arrays, FFT plans and other constants in the SpectralTransform struct <code>S</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_transform.jl#L438-L448">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.gridded" href="#SpeedyWeather.SpeedyTransforms.gridded"><code>SpeedyWeather.SpeedyTransforms.gridded</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">map = gridded(  alms::AbstractMatrix;
                recompute_legendre::Bool=true,
                grid::Type{&lt;:AbstractGrid}=DEFAULT_GRID)</code></pre><p>Spectral transform (spectral to grid space) from spherical coefficients <code>alms</code> to a newly allocated gridded field <code>map</code>. Based on the size of <code>alms</code> the grid type <code>grid</code>, the spatial resolution is retrieved based on the truncation defined for <code>grid</code>. SpectralTransform struct <code>S</code> is allocated to execute <code>gridded(alms,S)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_transform.jl#L543-L550">source</a></section><section><div><pre><code class="nohighlight hljs">map = gridded(  alms::AbstractMatrix,
                S::SpectralTransform)</code></pre><p>Spectral transform (spectral to grid space) from spherical coefficients <code>alms</code> to a newly allocated gridded field <code>map</code> with precalculated properties based on the SpectralTransform struct <code>S</code>. <code>alms</code> is converted to a <code>LowerTriangularMatrix</code> to execute the in-place <code>gridded!</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_transform.jl#L561-L567">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.gridded!" href="#SpeedyWeather.SpeedyTransforms.gridded!"><code>SpeedyWeather.SpeedyTransforms.gridded!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">gridded!(   diagn::DiagnosticVariables{NF}, # all diagnostic variables
            progn::PrognosticVariables{NF}, # all prognostic variables
            M::BarotropicModel,             # everything that&#39;s constant
            lf::Int=1                       # leapfrog index
            ) where NF</code></pre><p>Propagate the spectral state of the prognostic variables <code>progn</code> to the diagnostic variables in <code>diagn</code> for the barotropic vorticity model. Updates grid vorticity, spectral stream function and spectral and grid velocities u,v.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/dynamics/tendencies_dynamics.jl#L657-L666">source</a></section><section><div><pre><code class="nohighlight hljs">gridded!(   diagn::DiagnosticVariables{NF}, # all diagnostic variables
            progn::PrognosticVariables{NF}, # all prognostic variables
            lf::Int=1                       # leapfrog index
            M::ShallowWaterModel,           # everything that&#39;s constant
            ) where NF</code></pre><p>Propagate the spectral state of the prognostic variables <code>progn</code> to the diagnostic variables in <code>diagn</code> for the shallow water model. Updates grid vorticity, grid divergence, grid interface displacement (<code>pres_grid</code>) and the velocities U,V (scaled by cos(lat)).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/dynamics/tendencies_dynamics.jl#L692-L702">source</a></section><section><div><pre><code class="nohighlight hljs">gridded!(   map::AbstractGrid,
            alms::LowerTriangularMatrix,
            S::SpectralTransform)</code></pre><p>Spectral transform (spectral to grid) of the spherical harmonic coefficients <code>alms</code> to a gridded field <code>map</code>. The spectral transform is number format-flexible as long as the parametric types of <code>map</code>, <code>alms</code>, <code>S</code> are identical. The spectral transform is grid-flexible as long as the <code>typeof(map)&lt;:AbstractGrid</code>.  Uses the precalculated arrays, FFT plans and other constants in the SpectralTransform struct <code>S</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_transform.jl#L331-L339">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.triangular_truncation</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.roundup_fft</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">alms_trunc = spectral_truncation(alms,trunc)</code></pre><p>Returns a spectral coefficient matrix <code>alms_trunc</code> that is truncated from <code>alms</code> to the size (<code>trunc</code>+1)². <code>alms_trunc</code> only contains those coefficient of <code>alms</code> for which <code>m,l ≤ trunc</code>, and <code>l ≥ m</code> are zero anyway. If <code>trunc</code> is larger than the implicit truncation in <code>alms</code> obtained from its size than <code>spectral_interpolation</code> is automatically called instead, returning <code>alms_interp</code>, a coefficient matrix that is larger than <code>alms</code> with padded zero coefficients.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_truncation.jl#L78-L85">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.spectral_truncation!" href="#SpeedyWeather.SpeedyTransforms.spectral_truncation!"><code>SpeedyWeather.SpeedyTransforms.spectral_truncation!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">spectral_truncation!(alms::AbstractMatrix,ltrunc::Integer,mtrunc::Integer)</code></pre><p>Truncate spectral coefficients <code>alms</code> in-place by setting (a) the upper right triangle to zero and (b) all coefficients for which the degree <code>l</code> is larger than the truncation <code>ltrunc</code> or order <code>m</code> larger than the truncaction <code>mtrunc</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_truncation.jl#L1-L6">source</a></section><section><div><pre><code class="nohighlight hljs">spectral_truncation!(alms::LowerTriangularMatrix,ltrunc::Integer,mtrunc::Integer)</code></pre><p>Truncate spectral coefficients <code>alms</code> in-place by setting all coefficients for which the degree <code>l</code> is larger than the truncation <code>ltrunc</code> or order <code>m</code> larger than the truncaction <code>mtrunc</code>. Similar to <code>spectral_truncation!(::AbstractMatrix, ...)</code> but skips the upper triangle which is zero by design for <code>LowerTriangularMatrix</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_truncation.jl#L27-L33">source</a></section><section><div><pre><code class="nohighlight hljs">spectral_truncation!(alms,trunc)</code></pre><p>Truncate spectral coefficients <code>alms</code> in-place by setting (a) the upper right triangle to zero and (b) all coefficients for which the degree l is larger than the truncation <code>trunc</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_truncation.jl#L56-L60">source</a></section><section><div><pre><code class="nohighlight hljs">spectral_truncation!(alms)</code></pre><p>Truncate spectral coefficients <code>alms</code> in-place by setting the upper right triangle to zero. This is to enforce that all coefficients for which the degree l is larger than order m are zero.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_truncation.jl#L66-L70">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.spectral_interpolation!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.get_legendre_polynomials!</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇²!" href="#SpeedyWeather.SpeedyTransforms.∇²!"><code>SpeedyWeather.SpeedyTransforms.∇²!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">∇²!(    ∇²alms::LowerTriangularMatrix,
        alms::LowerTriangularMatrix,
        S::SpectralTransform;
        add::Bool=false,
        flipsign::Bool=false,
        inverse::Bool=false)</code></pre><p>Laplace operator ∇² applied to the spectral coefficients <code>alms</code> in spherical coordinates. The radius <code>R</code> is omitted in the eigenvalues which are precomputed in <code>S</code>. ∇²! is the in-place version which directly stores the output in the first argument <code>∇²alms</code>.</p><p><strong>Keyword arguments</strong></p><ul><li><code>add=true</code> adds the ∇²(alms) to the output</li><li><code>flipsign=true</code> computes -∇²(alms) instead</li><li><code>inverse=true</code> computes ∇⁻²(alms) instead</li></ul><p>Default is <code>add=false</code>, <code>flipsign=false</code>, <code>inverse=false</code>. These options can be combined.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_gradients.jl#L269-L288">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.∇²</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.∇⁻²!" href="#SpeedyWeather.SpeedyTransforms.∇⁻²!"><code>SpeedyWeather.SpeedyTransforms.∇⁻²!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">∇⁻²!(   ∇⁻²alms::LowerTriangularMatrix,
        alms::LowerTriangularMatrix,
        S::SpectralTransform;
        add::Bool=false,
        flipsign::Bool=false)</code></pre><p>Calls <code>∇²!(∇⁻²alms, alms, S; add, flipsign, inverse=true)</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_gradients.jl#L318-L325">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.∇⁻²</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.gradient_latitude!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.gradient_latitude</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.gradient_longitude!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.gradient_longitude</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.divergence!" href="#SpeedyWeather.SpeedyTransforms.divergence!"><code>SpeedyWeather.SpeedyTransforms.divergence!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">divergence!(div::LowerTriangularMatrix,
            u::LowerTriangularMatrix,
            v::LowerTriangularMatrix,
            S::SpectralTransform{NF};
            flipsign::Bool=false,
            add::Bool=false,
            )</code></pre><p>Divergence of a vector <code>u,v</code> written into <code>div</code>, <code>div = ∇⋅(u,v)</code>.  <code>u,v</code> are expected to have a 1/coslat-scaling included, then <code>div</code> is not scaled. <code>flipsign</code> option calculates -∇⋅(u,v) instead. <code>add</code> option calculates <code>div += ∇⋅(u,v)</code> instead. <code>flipsign</code> and <code>add</code> can be combined. This functions only creates the kernel and calls the generic divergence function _divergence! subsequently.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_gradients.jl#L29-L42">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.curl!" href="#SpeedyWeather.SpeedyTransforms.curl!"><code>SpeedyWeather.SpeedyTransforms.curl!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">curl!(  curl::LowerTriangularMatrix,
        u::LowerTriangularMatrix,
        v::LowerTriangularMatrix,
        S::SpectralTransform;
        flipsign::Bool=false,
        add::Bool=false,
        )</code></pre><p>Curl of a vector <code>u,v</code> written into <code>curl</code>, <code>curl = ∇×(u,v)</code>. <code>u,v</code> are expected to have a 1/coslat-scaling included, then <code>curl</code> is not scaled. <code>flipsign</code> option calculates -∇×(u,v) instead. <code>add</code> option calculates <code>curl += ∇×(u,v)</code> instead. <code>flipsign</code> and <code>add</code> can be combined. This functions only creates the kernel and calls the generic divergence function _divergence! subsequently with flipped u,v -&gt; v,u for the curl.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_gradients.jl#L1-L14">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather._divergence!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.curl_div!</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.UV_from_vordiv!" href="#SpeedyWeather.SpeedyTransforms.UV_from_vordiv!"><code>SpeedyWeather.SpeedyTransforms.UV_from_vordiv!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">UV_from_vordiv!(U::LowerTriangularMatrix,
                V::LowerTriangularMatrix,
                vor::LowerTriangularMatrix,
                div::LowerTriangularMatrix,
                S::SpectralTransform)</code></pre><p>Get U,V (=(u,v)*coslat) from vorticity ζ and divergence D in spectral space. Two operations are combined into a single linear operation. First, invert the spherical Laplace ∇² operator to get stream function from vorticity and velocity potential from divergence. Then compute zonal and meridional gradients to get U,V.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_gradients.jl#L180-L191">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.SpeedyTransforms.UV_from_vor!" href="#SpeedyWeather.SpeedyTransforms.UV_from_vor!"><code>SpeedyWeather.SpeedyTransforms.UV_from_vor!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">UV_from_vor!(   U::LowerTriangularMatrix,
                V::LowerTriangularMatrix,
                vor::LowerTriangularMatrix,
                S::SpectralTransform)</code></pre><p>Get U,V (=(u,v)*coslat) from vorticity ζ spectral space (divergence D=0) Two operations are combined into a single linear operation. First, invert the spherical Laplace ∇² operator to get stream function from vorticity. Then compute zonal and meridional gradients to get U,V.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/SpeedyTransforms/spectral_gradients.jl#L109-L118">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.ϵlm</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.get_recursion_factors</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Dynamics"><a class="docs-heading-anchor" href="#Dynamics">Dynamics</a><a id="Dynamics-1"></a><a class="docs-heading-anchor-permalink" href="#Dynamics" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.bernoulli_potential!" href="#SpeedyWeather.bernoulli_potential!"><code>SpeedyWeather.bernoulli_potential!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">bernoulli_potential!(   diagn::DiagnosticVariablesLayer, 
                        G::Geometry,
                        S::SpectralTransform)</code></pre><p>Computes the Laplace operator ∇² of the Bernoulli potential <code>B</code> in spectral space.</p><ol><li>computes the kinetic energy KE = ½(u²+v²) on the grid</li><li>transforms KE to spectral space</li><li>adds geopotential for the Bernoulli potential in spectral space</li><li>takes the Laplace operator.</li></ol><p>This version is used for both ShallowWater and PrimitiveEquation, only the geopotential calculation in geopotential! differs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/dynamics/tendencies_dynamics.jl#L545-L557">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.volume_flux_divergence!" href="#SpeedyWeather.volume_flux_divergence!"><code>SpeedyWeather.volume_flux_divergence!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">volume_flux_divergence!(diagn::DiagnosticVariablesLayer,
                        surface::SurfaceVariables,
                        model::ShallowWater)</code></pre><p>Computes the (negative) divergence of the volume fluxes <code>uh,vh</code> for the continuity equation, -∇⋅(uh,vh).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/dynamics/tendencies_dynamics.jl#L593-L598">source</a></section></article><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.vorticity_fluxes!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.vorticity_flux_curl!</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SpeedyWeather.vorticity_flux_divergence!</code>. Check Documenter&#39;s build log for details.</p></div></div><h2 id="Geometry"><a class="docs-heading-anchor" href="#Geometry">Geometry</a><a id="Geometry-1"></a><a class="docs-heading-anchor-permalink" href="#Geometry" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.Geometry" href="#SpeedyWeather.Geometry"><code>SpeedyWeather.Geometry</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia hljs">Geometry{NF&lt;:AbstractFloat} &lt;: AbstractGeometry</code></pre><p>Geometry struct containing parameters and arrays describing an iso-latitude grid &lt;:AbstractGrid and the vertical levels. NF is the number format used for the precomputed constants.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/dynamics/geometry.jl#L1-L6">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.vertical_coordinates" href="#SpeedyWeather.vertical_coordinates"><code>SpeedyWeather.vertical_coordinates</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">σ_levels_half = vertical_coordinates(P::Parameters)</code></pre><p>Vertical sigma coordinates defined by their nlev+1 half levels <code>σ_levels_half</code>. Sigma coordinates are fraction of surface pressure (p/p0) and are sorted from top (stratosphere) to bottom (surface). The first half level is at 0 the last at 1. Evaluate a generalised logistic function with coefficients in <code>P</code> for the distribution of values in between. Default coefficients follow the L31 configuration historically used at ECMWF.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/dynamics/geometry.jl#L190-L197">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.GenLogisticCoefs" href="#SpeedyWeather.GenLogisticCoefs"><code>SpeedyWeather.GenLogisticCoefs</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Coefficients of the generalised logistic function to describe the vertical coordinate. Default coefficients A,K,C,Q,B,M,ν are fitted to the old L31 configuration at ECMWF. See geometry.jl and function <code>vertical_coordinate</code> for more informaiton.</p><p>Following the notation of <a href="https://en.wikipedia.org/wiki/Generalised_logistic_function">https://en.wikipedia.org/wiki/Generalised<em>logistic</em>function</a> (Dec 15 2021).</p><p>Change default parameters for more/fewer levels in the stratosphere vs troposphere vs boundary layer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/dynamics/geometry.jl#L167-L174">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.generalised_logistic" href="#SpeedyWeather.generalised_logistic"><code>SpeedyWeather.generalised_logistic</code></a> — <span class="docstring-category">Function</span></header><section><div><p>Generalised logistic function based on the coefficients in <code>coefs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/dynamics/geometry.jl#L184">source</a></section></article><h2 id="Time-stepping"><a class="docs-heading-anchor" href="#Time-stepping">Time stepping</a><a id="Time-stepping-1"></a><a class="docs-heading-anchor-permalink" href="#Time-stepping" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.time_stepping!" href="#SpeedyWeather.time_stepping!"><code>SpeedyWeather.time_stepping!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">time_stepping!( progn::PrognosticVariables,     # all prognostic variables
                diagn::DiagnosticVariables,     # all pre-allocated diagnostic variables
                model::ModelSetup)              # all precalculated structs</code></pre><p>Main time loop that that initialises output and feedback, loops over all time steps and calls the output and feedback functions.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/dynamics/time_integration.jl#L238-L244">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.timestep!" href="#SpeedyWeather.timestep!"><code>SpeedyWeather.timestep!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">timestep!(  progn::PrognosticVariables,     # all prognostic variables
            diagn::DiagnosticVariables,     # all pre-allocated diagnostic variables
            time::DateTime,                 # time at timestep
            dt::Real,                       # time step (mostly =2Δt, but for init steps =Δt,Δt/2)
            lf1::Int=2,                     # leapfrog index 1 (dis/enables Robert+William&#39;s filter)
            lf2::Int=2,                     # leapfrog index 2 (time step used for tendencies)
            M::BarotropicModel,             # everything that&#39;s constant at runtime
            )</code></pre><p>Calculate a single time step for the barotropic vorticity equation model of SpeedyWeather.jl </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/dynamics/time_integration.jl#L110-L120">source</a></section><section><div><pre><code class="nohighlight hljs">timestep!(  progn::PrognosticVariables{NF}, # all prognostic variables
            diagn::DiagnosticVariables{NF}, # all pre-allocated diagnostic variables
            time::DateTime,                 # time at timestep
            dt::Real,                       # time step (mostly =2Δt, but for init steps =Δt,Δt/2)
            M::ShallowWaterModel,           # everything that&#39;s constant at runtime
            lf1::Int=2,                     # leapfrog index 1 (dis/enables Robert+William&#39;s filter)
            lf2::Int=2                      # leapfrog index 2 (time step used for tendencies)
            ) where {NF&lt;:AbstractFloat}</code></pre><p>Calculate a single time step for the shallow water model of SpeedyWeather.jl </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/dynamics/time_integration.jl#L140-L150">source</a></section><section><div><pre><code class="nohighlight hljs">timestep!(  progn::PrognosticVariables{NF}, # all prognostic variables
            diagn::DiagnosticVariables{NF}, # all pre-allocated diagnostic variables
            time::DateTime,                 # time at timestep
            dt::Real,                       # time step (mostly =2Δt, but for init steps =Δt,Δt/2)
            M::PrimitiveEquation,      # everything that&#39;s constant at runtime
            lf1::Int=2,                     # leapfrog index 1 (dis/enables Robert+William&#39;s filter)
            lf2::Int=2                      # leapfrog index 2 (time step used for tendencies)
            ) where {NF&lt;:AbstractFloat}</code></pre><p>Calculate a single time step for the primitive equation model of SpeedyWeather.jl </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/dynamics/time_integration.jl#L185-L195">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.first_timesteps!" href="#SpeedyWeather.first_timesteps!"><code>SpeedyWeather.first_timesteps!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">first_timesteps!(   progn::PrognosticVariables, # all prognostic variables
                    diagn::DiagnosticVariables, # all pre-allocated diagnostic variables
                    time::DateTime,             # time at timestep
                    M::ModelSetup,              # everything that is constant at runtime
                    feedback::AbstractFeedback  # feedback struct
                    )</code></pre><p>Performs the first two initial time steps (Euler forward, unfiltered leapfrog) to populate the prognostic variables with two time steps (t=0,Δt) that can then be used in the normal leap frogging.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/dynamics/time_integration.jl#L65-L74">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.leapfrog!" href="#SpeedyWeather.leapfrog!"><code>SpeedyWeather.leapfrog!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">leapfrog!(  A_old::LowerTriangularMatrix{Complex{NF}},      # prognostic variable at t
            A_new::LowerTriangularMatrix{Complex{NF}},      # prognostic variable at t+dt
            tendency::LowerTriangularMatrix{Complex{NF}},   # tendency (dynamics+physics) of A
            dt::Real,                                       # time step (=2Δt, but for init steps =Δt,Δt/2)
            lf::Int=2,                                      # leapfrog index to dis/enable William&#39;s filter
            C::DynamicsConstants{NF},                       # struct with constants used at runtime
            ) where {NF&lt;:AbstractFloat}                     # number format NF</code></pre><p>Performs one leapfrog time step with (<code>lf=2</code>) or without (<code>lf=1</code>) Robert+William&#39;s filter (see William (2009), Montly Weather Review, Eq. 7-9).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/dynamics/time_integration.jl#L1-L12">source</a></section></article><h2 id="Longwave-radiation"><a class="docs-heading-anchor" href="#Longwave-radiation">Longwave radiation</a><a id="Longwave-radiation-1"></a><a class="docs-heading-anchor-permalink" href="#Longwave-radiation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.radset!" href="#SpeedyWeather.radset!"><code>SpeedyWeather.radset!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function radset!(model::PrimitiveEquation) where {NF&lt;:AbstractFloat}</code></pre><p>Compute energy fractions in four longwave bands as a function of temperature.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/physics/longwave_radiation.jl#L29-L34">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.radlw_down!" href="#SpeedyWeather.radlw_down!"><code>SpeedyWeather.radlw_down!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function radlw_down!(
    column::ColumnVariables{NF}, model::PrimitiveEquation
) where {NF&lt;:AbstractFloat}</code></pre><p>Compute the downward flux of longwave radiation. Inputs variables are <code>temp</code><code>,</code>wvi<code>,</code>tau2<code>. Output column varables are</code>fsfcd<code>,</code>dfabs<code>,</code>flux<code>,</code>st4a`.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/physics/longwave_radiation.jl#L62-L69">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.compute_bbe!" href="#SpeedyWeather.compute_bbe!"><code>SpeedyWeather.compute_bbe!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function compute_bbe!(
    column::ColumnVariables{NF}, model::PrimitiveEquation
) where {NF&lt;:AbstractFloat}</code></pre><p><strong>Computes black-body (or grey-body) emissions.</strong></p><p>Input and output variables are <code>ts</code> and <code>fsfcu</code>, respectively.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/physics/longwave_radiation.jl#L161-L168">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.radlw_up!" href="#SpeedyWeather.radlw_up!"><code>SpeedyWeather.radlw_up!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function radlw_up!(
    column::ColumnVariables{NF}, model::PrimitiveEquation
) where {NF&lt;:AbstractFloat}</code></pre><p><strong>Computes the upward flux of longwave radiation.</strong></p><p>Input variables are  <code>nlev</code>, <code>temp</code>, <code>fsfcu</code>, <code>fsfcd</code>, <code>flux</code>, <code>ts</code>, <code>tau2</code>, <code>st4a</code>, <code>dfabs</code>, <code>stratc</code>, <code>σ_levels_thick</code>, <code>n_stratosphere_levels</code>. Output column variables are <code>fsfc</code> and <code>ftop</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/physics/longwave_radiation.jl#L180-L187">source</a></section></article><h2 id="Shortwave-radiation"><a class="docs-heading-anchor" href="#Shortwave-radiation">Shortwave radiation</a><a id="Shortwave-radiation-1"></a><a class="docs-heading-anchor-permalink" href="#Shortwave-radiation" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.shortwave_radiation!" href="#SpeedyWeather.shortwave_radiation!"><code>SpeedyWeather.shortwave_radiation!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function shortwave_radiation!(
    column::ColumnVariables{NF}, model::PrimitiveEquation
)</code></pre><p>Compute air temperature tendencies from shortwave radiation for an atmospheric column. For more details see http://users.ictp.it/~kucharsk/speedy<em>description/km</em>ver41_appendixA.pdf</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/physics/shortwave_radiation.jl#L45-L52">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.solar!" href="#SpeedyWeather.solar!"><code>SpeedyWeather.solar!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function solar!(column::ColumnVariables{NF})</code></pre><p>Compute average daily flux of solar radiation for an atmospheric column, from Hartmann (1994).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/physics/shortwave_radiation.jl#L79-L84">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.sol_oz!" href="#SpeedyWeather.sol_oz!"><code>SpeedyWeather.sol_oz!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function sol_oz!(
    column::ColumnVariables{NF}, model::PrimitiveEquation
)</code></pre><p>Compute solar radiation parametres for an atmospheric column.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/physics/shortwave_radiation.jl#L123-L129">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.cloud!" href="#SpeedyWeather.cloud!"><code>SpeedyWeather.cloud!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function cloud!(
    column::ColumnVariables{NF}, model::PrimitiveEquation
)</code></pre><p>Compute shortwave radiation cloud contibutions for an atmospheric column.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/physics/shortwave_radiation.jl#L177-L183">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="SpeedyWeather.radsw!" href="#SpeedyWeather.radsw!"><code>SpeedyWeather.radsw!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">function radsw!(
    column::ColumnVariables{NF}, model::PrimitiveEquation
)</code></pre><p>Compute shortwave radiation fluxes for an atmospheric column.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SpeedyWeather/SpeedyWeather.jl/blob/d2c44093b4d62308839463dd49099d59db902af7/src/physics/shortwave_radiation.jl#L237-L243">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../new_model_setups/">« New model setups</a><a class="docs-footer-nextpage" href="../conventions/">Style and convention guide »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Tuesday 23 May 2023 23:16">Tuesday 23 May 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
